/* MODELAGEM Exercício COMERCIO */

CREATE DATABASE EXERCICIO;
USE EXERCICIO;

CREATE TABLE CLIENTE (
	IDCLIENTE INT PRIMARY KEY AUTO_INCREMENT,
	NOME VARCHAR (30) NOT NULL,
	SEXO ENUM ('M', 'F') NOT NULL,
	EMAIL VARCHAR (50) UNIQUE,
	CPF VARCHAR (15) UNIQUE
);

CREATE TABLE ENDERECO (
	IDENDERECO INT PRIMARY KEY AUTO_INCREMENT,
	RUA VARCHAR (30) NOT NULL,
	BAIRRO VARCHAR (30) NOT NULL,
	CIDADE VARCHAR (30) NOT NULL,
	ESTADO CHAR (2) NOT NULL,
	ID_CLIENTE INT UNIQUE,
	FOREIGN KEY (ID_CLIENTE)
	REFERENCES CLIENTE (IDCLIENTE)
);

CREATE TABLE TELEFONE (
	IDTELEFONE INT PRIMARY KEY AUTO_INCREMENT,
	TIPO  ENUM ('RES', 'COM', 'CEL') NOT NULL,
	NUMERO VARCHAR (10) NOT NULL,
	ID_CLIENTE INT,
	FOREIGN KEY (ID_CLIENTE)
	REFERENCES CLIENTE (IDCLIENTE)
);

INSERT INTO CLIENTE VALUES (NULL, 'JOAO', 'M', 'JOAO@GMAIL.COM', '76777755585');
INSERT INTO CLIENTE VALUES (NULL, 'JOSE', 'M', 'JOSE@GMAIL.COM', '76788855585');
INSERT INTO CLIENTE VALUES (NULL, 'SARA', 'F', 'SARA@GMAIL.COM', '76777154585');
INSERT INTO CLIENTE VALUES (NULL, 'PAULO', 'M', 'PAULO@GMAIL.COM', '76478755585');
INSERT INTO CLIENTE VALUES (NULL, 'TEREZA', 'F', 'TEREZA@GMAIL.COM', '76777755956');

INSERT INTO ENDERECO VALUES (NULL, 'RUA ANTONIO BARBOSA', 'CENTRO', 'B. HORIZONTE', 'MG', 1);
INSERT INTO ENDERECO VALUES (NULL, 'RUA JOAQUIM ROSA', 'CLETO', 'CARIACICA', 'ES', 2);
INSERT INTO ENDERECO VALUES (NULL, 'RUA EDMAR DIAS', 'SAO JOAO', 'BERRANTE', 'SP', 3);
INSERT INTO ENDERECO VALUES (NULL, 'RUA BARAO SA', 'ABCD', 'VITORIA', 'ES', 4);
INSERT INTO ENDERECO VALUES (NULL, 'RUA ROSA CEARA', 'CENTRO', 'CASTELO BRANCO', 'MG', 5);

INSERT INTO TELEFONE VALUES (NULL, 'RES', '89998585', 5);
INSERT INTO TELEFONE VALUES (NULL, 'COM', '45598585', 5);
INSERT INTO TELEFONE VALUES (NULL, 'CEL', '12987462', 1);
INSERT INTO TELEFONE VALUES (NULL, 'CEL', '58998478', 2);
INSERT INTO TELEFONE VALUES (NULL, 'COM', '98719585', 3);
INSERT INTO TELEFONE VALUES (NULL, 'RES', '93666585', 3);
INSERT INTO TELEFONE VALUES (NULL, 'CEL', '96698585', 5);

/* JOIN 2 TABELAS */

SELECT NOME, SEXO, BAIRRO, CIDADE
FROM CLIENTE
INNER JOIN ENDERECO
ON IDCLIENTE = ID_CLIENTE;

SELECT NOME, SEXO, EMAIL, TIPO, NUMERO
FROM CLIENTE
INNER JOIN TELEFONE
ON IDCLIENTE = ID_CLIENTE;

/* JOIN 3 TABELAS */
/*
SELECT CLIENTE.NOME, CLIENTE.SEXO, ENDERECO.BAIRRO, ENDERECO.CIDADE, TELEFONE.TIPO, TELEFONE.NUMERO
FROM CLIENTE
INNER JOIN ENDERECO
ON CLIENTE.IDCLIENTE = ENDERECO.ID_CLIENTE
INNER JOIN TELEFONE
ON CLIENTE.IDCLIENTE = TELEFONE.ID_CLIENTE;

OU

SELECT C.NOME, C.SEXO, E.BAIRRO, E.CIDADE, T.TIPO, T.NUMERO
FROM CLIENTE C
INNER JOIN ENDERECO E
ON C.IDCLIENTE = E.ID_CLIENTE
INNER JOIN TELEFONE T
ON C.IDCLIENTE = T.ID_CLIENTE;

*/

/*

/* EXERCÍCIOS */
SELECT C.IDCLIENTE, C.NOME, C.SEXO, C.EMAIL, C.CPF, 
	E.RUA, E.BAIRRO, E.CIDADE, E.ESTADO, 
	T.TIPO, T.NUMERO
FROM CLIENTE C
INNER JOIN ENDERECO E
ON C.IDCLIENTE = E.ID_CLIENTE
INNER JOIN TELEFONE T
ON C.IDCLIENTE = T.ID_CLIENTE;


SELECT C.IDCLIENTE, C.NOME, C.SEXO, C.EMAIL, C.CPF, 
	E.RUA, E.BAIRRO, E.CIDADE, E.ESTADO, 
	T.TIPO, T.NUMERO
FROM CLIENTE C
INNER JOIN ENDERECO E
ON C.IDCLIENTE = E.ID_CLIENTE
INNER JOIN TELEFONE T
ON C.IDCLIENTE = T.ID_CLIENTE
WHERE SEXO = 'M';


SELECT COUNT(*) AS QUANTIDADE, SEXO
FROM CLIENTE
GROUP BY SEXO;

SELECT C.IDCLIENTE, C.EMAIL, C.NOME, C.SEXO, T.TIPO, E.BAIRRO, E.CIDADE
FROM CLIENTE C
INNER JOIN ENDERECO E
ON C.IDCLIENTE = E.ID_CLIENTE
INNER JOIN TELEFONE T
ON C.IDCLIENTE = T.ID_CLIENTE
WHERE SEXO = 'M'
AND BAIRRO = 'CENTRO' AND CIDADE = 'B. HORIZONTE'
AND TIPO = 'RES' OR TIPO = 'COM';
